---
layout: layout.njk
---

<h1>üëãüèæ</h1>

<p>
  I  used to <a href="https://linkedin.com/in/mehulkar" target="_blank" rel="noopener">work at Apple</a>, but after ten years,
  I've just accepted an offer at <a href="https://vercel.com">Vercel</a> to work on <a href="https://turborepo.org">Turborepo</a>,
  starting on August 1st!
</p>
<p>
  The best way to see what I'm  interested in is to glance through my <a href="https://twitter.com/mehulkar/likes" target="_blank" rel="noopener">Twitter favorites</a>
  or see what I'm reading on <a href="https://www.goodreads.com/user/show/27391275-mehul" target="_blank" rel="noopener">Goodreads</a>.
  But you can also stay here and read what I'm thinking about. Here's a printable <a href="/resume">resume</a>.
</p>

<h2 class="mb3">Recently</h2>
<ul class="small">
  <li>
    Watched <span id="movie">...</span> <span id="movie-date">...</span> and rated it <span id="rating">0/5</span>.
  </li>
  <li>
    <p id="tweet-preamble">Liked a tweet from:</p>
    <blockquote id="tweet"></blockquote>
  </li>
</ul>

<h2 class="mb3">Posts</h2>

{% set posts = collections.byYear | category("programming") %}
{% from 'partials/_by-year.njk' import render %}
{{ render(posts) }}

<script type="module">
  const response = await fetch('/api/watching');
  const data = await response.json();
  console.log('movie', data);
  const { name, rating, watchedOn, url } = data;
  const daysAgo = Math.round((new Date() - new Date(watchedOn)) / 1000 / 60 / 60 / 24);
  const date = new Intl.RelativeTimeFormat('en', { style: 'narrow' }).format(daysAgo * -1, 'days')

  document.getElementById('movie').innerHTML = `<a href="${url}">${name}</a>`;
  document.getElementById('movie-date').innerText = date;
  document.getElementById('rating').innerText = `${rating}/5 stars`;
</script>

<script nomodule>
  var req = new XMLHttpRequest();
  req.addEventListener("load", function(res) {
    const data = JSON.parse(req.responseText);
    const { name, rating, watchedOn, url } = data;
    const daysAgo = Math.round((new Date() - new Date(watchedOn)) / 1000 / 60 / 60 / 24);
    const date = new Intl.RelativeTimeFormat('en', { style: 'narrow' }).format(daysAgo * -1, 'days')

    document.getElementById('movie').innerHTML = `<a href="${url}">${name}</a>`;
    document.getElementById('movie-date').innerText = date;
    document.getElementById('rating').innerText = `${rating}/5 stars`;
  });

  req.open("GET", "/api/watching");
  req.send();
</script>

<script type="module">
  const response = await fetch('/api/fave-tweet');
  const data = await response.json();
  console.log('tweet', data);
  const { tweet, author } = data;
  const url = `https://twitter.com/${author.username}/status/${tweet.id}`;
  const authorUrl = `https://twitter.com/${author.username}`;

  document.getElementById('tweet-preamble').innerHTML = `Liked <a href="${url}" target="_blank" rel="noopener">a tweet</a> from <a href="${authorUrl}">@${author.username}</a>:`;
  document.getElementById('tweet').innerHTML = tweet.html;
</script>

<script nomodule>
  var req = new XMLHttpRequest();
  req.addEventListener("load", function(res) {
    const data = JSON.parse(req.responseText);
    console.log('xhr tweet', data);
    const { tweet, author } = data;
    const url = `https://twitter.com/${author.username}/status/${tweet.id}`;
    const authorUrl = `https://twitter.com/${author.username}`;

    document.getElementById('tweet-preamble').innerHTML = `Liked <a href="${url}" target="_blank" rel="noopener">a tweet</a> from <a href="${authorUrl}">@${author.username}</a>:`;
    document.getElementById('tweet').innerHTML = tweet.html;
  });

  req.open("GET", "/api/fave-tweet");
  req.send();

</script>
